<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0052cc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>–°–ò–ù–Ø–Ø –ò–ó–û–õ–ï–ù–¢–ê | –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</title>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* –¢–µ–º–∞ 1: Classic Engineering (Blue) */
            --bg-color: #f4f7f6;
            --panel-bg: #ffffff;
            --accent-color: #0052cc;
            --text-main: #2c3e50;
            --border-color: #d1d8e0;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è */
        body.theme-dark {
            --bg-color: #1a1a1a; --panel-bg: #2d2d2d; --accent-color: #3498db; --text-main: #e0e0e0; --border-color: #444;
        }
        body.theme-grease {
            --bg-color: #2b2622; --panel-bg: #3d352f; --accent-color: #f39c12; --text-main: #ecf0f1; --border-color: #5d534a;
        }
        body.theme-blueprint {
            --bg-color: #003366; --panel-bg: #004080; --accent-color: #ffffff; --text-main: #ffffff; --border-color: rgba(255,255,255,0.3);
        }
        body.theme-safety {
            --bg-color: #000000; --panel-bg: #1a1a1a; --accent-color: #ffff00; --text-main: #ffffff; --border-color: #ffff00;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; font-family: 'Roboto', sans-serif; background-color: var(--bg-color);
            color: var(--text-main); transition: all 0.3s ease; overflow-x: hidden;
        }

        /* Navigation */
        nav {
            position: fixed; bottom: 0; left: 0; width: 100%; background: var(--panel-bg);
            display: flex; justify-content: space-around; padding: 10px 0;
            border-top: 2px solid var(--accent-color); z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            font-size: 10px; cursor: pointer; color: var(--text-main); opacity: 0.6;
        }
        .nav-item.active { opacity: 1; color: var(--accent-color); }

        /* Content Container */
        main { padding: 20px; padding-bottom: 80px; max-width: 1200px; margin: 0 auto; }
        .page { display: none; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* UI Elements */
        .card {
            background: var(--panel-bg); border: 1px solid var(--border-color);
            border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: var(--card-shadow);
        }
        h2 { border-left: 4px solid var(--accent-color); padding-left: 10px; margin-top: 0; }
        input, select, button {
            width: 100%; padding: 12px; margin: 5px 0; border: 1px solid var(--border-color);
            border-radius: 5px; background: var(--panel-bg); color: var(--text-main);
        }
        button { background: var(--accent-color); color: white; border: none; font-weight: bold; cursor: pointer; }

        /* Page Specific: Calendar */
        .calendar-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center;
        }
        .day { padding: 10px 2px; border-radius: 4px; font-size: 14px; }
        .day.weekend { color: #e74c3c; font-weight: bold; }
        .day.holiday { background: rgba(231, 76, 60, 0.2); border: 1px solid #e74c3c; }
        .day.today { background: var(--accent-color); color: white; }
        .murphy-box { font-style: italic; border-top: 1px dashed var(--accent-color); margin-top: 20px; padding: 10px; font-size: 0.9em; }

        /* Page Specific: Reference Tables */
        .table-scroll { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-family: 'JetBrains Mono', monospace; font-size: 13px; }
        th, td { border: 1px solid var(--border-color); padding: 8px; text-align: left; }
        th { background: rgba(0,0,0,0.05); }

        /* Responsive Design */
        @media (min-width: 768px) {
            nav { top: 0; bottom: auto; flex-direction: column; width: 70px; height: 100vh; padding: 20px 0; }
            main { margin-left: 80px; }
            .calendar-grid { gap: 10px; }
        }

        /* Floating Settings Button */
        .fab { position: fixed; right: 20px; top: 20px; z-index: 1001; background: var(--accent-color); color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        
        #modal-settings {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

    <div class="fab" onclick="toggleSettings()"><i data-lucide="settings"></i></div>

    <nav id="main-nav">
        <div class="nav-item active" onclick="showPage('p-cal')"><i data-lucide="calendar"></i><span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</span></div>
        <div class="nav-item" onclick="showPage('p-chat')"><i data-lucide="message-square"></i><span>–ß–∞—Ç</span></div>
        <div class="nav-item" onclick="showPage('p-stock')"><i data-lucide="package"></i><span>–°–∫–ª–∞–¥</span></div>
        <div class="nav-item" onclick="showPage('p-ref')"><i data-lucide="book-open"></i><span>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫</span></div>
        <div class="nav-item" onclick="showPage('p-obd')"><i data-lucide="alert-triangle"></i><span>OBD-II</span></div>
        <div class="nav-item" onclick="showPage('p-ai')"><i data-lucide="cpu"></i><span>AI</span></div>
        <div class="nav-item" onclick="showPage('p-joke')"><i data-lucide="laugh"></i><span>–Æ–º–æ—Ä</span></div>
    </nav>

    <main>
        <section id="p-cal" class="page active">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <button onclick="changeMonth(-1)" style="width: 50px;">&lt;</button>
                    <h2 id="cal-title" style="border:none; margin:0;">–Ø–Ω–≤–∞—Ä—å 2024</h2>
                    <button onclick="changeMonth(1)" style="width: 50px;">&gt;</button>
                </div>
                <div class="calendar-grid" id="calendar-body">
                    </div>
                <div class="murphy-box">
                    <strong>–ó–∞–∫–æ–Ω –¥–Ω—è:</strong>
                    <p id="murphy-quote">–ï—Å–ª–∏ –≤—Å—ë –∏–¥–µ—Ç –ø–æ –ø–ª–∞–Ω—É, –∑–Ω–∞—á–∏—Ç, –≤—ã —á–µ–≥–æ-—Ç–æ –Ω–µ –∑–∞–º–µ—Ç–∏–ª–∏.</p>
                </div>
            </div>
        </section>

        <section id="p-chat" class="page">
            <h2>–ì—Ä—É–ø–ø–æ–≤–æ–π —Å–æ–≤–µ—Ç</h2>
            <div class="card" id="chat-box" style="height: 300px; overflow-y: auto; margin-bottom: 10px; background: #eee; color: #333; font-size: 0.9em;">
                <div style="padding: 5px;"><strong>–ê–¥–º–∏–Ω:</strong> –ö–æ–ª–ª–µ–≥–∏, –∫—Ç–æ –ø–æ–¥—Å–∫–∞–∂–µ—Ç –º–æ–º–µ–Ω—Ç –∑–∞—Ç—è–∂–∫–∏ –ì–ë–¶ –Ω–∞ D24?</div>
            </div>
            <div style="display: flex; gap: 5px;">
                <input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                <button style="width: 70px;"><i data-lucide="send"></i></button>
            </div>
        </section>

        <section id="p-stock" class="page">
            <h2>–°–∫–ª–∞–¥ –ø–æ–¥ –≤–µ—Ä—Å—Ç–∞–∫–æ–º</h2>
            <select id="stock-filter">
                <option>–£ –º–µ–Ω—è –µ—Å—Ç—å</option>
                <option>–ú–Ω–µ –Ω—É–∂–Ω–æ</option>
                <option>–ú–æ–≥—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è</option>
            </select>
            <div id="stock-list">
                <div class="card">
                    <strong>–î–∏–Ω–∞–º–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∫–ª—é—á (10-110 –ù–º)</strong>
                    <div style="font-size: 0.8em; color: gray;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –í–ª–∞–¥–µ–ª–µ—Ü: –ò–≤–∞–Ω</div>
                </div>
            </div>
            <button>+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</button>
        </section>

        <section id="p-ref" class="page">
            <h2>–†–µ–∑—å–±—ã –∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∏</h2>
            <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ä–∞–∑–º–µ—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, M12)..." onkeyup="filterTable()">
            <div class="table-scroll card">
                <table>
                    <thead><tr><th>–¢–∏–ø</th><th>–†–∞–∑–º–µ—Ä</th><th>–®–∞–≥</th><th>–°–≤–µ—Ä–ª–æ, –º–º</th></tr></thead>
                    <tbody id="ref-table-body">
                        <tr><td>–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è</td><td>M6</td><td>1.0</td><td>5.0</td></tr>
                        <tr><td>–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è</td><td>M8</td><td>1.25</td><td>6.8</td></tr>
                        <tr><td>–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è</td><td>M10</td><td>1.5</td><td>8.5</td></tr>
                        <tr><td>–î—é–π–º–æ–≤–∞—è</td><td>1/4" UNC</td><td>20 TPI</td><td>5.1</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="p-obd" class="page">
            <h2>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h2>
            <div style="display: flex; gap: 5px;">
                <input type="text" id="obd-search" placeholder="–ö–æ–¥ –æ—à–∏–±–∫–∏ (P0101, 520204...)">
                <button onclick="searchOBD()" style="width: 100px;">–ü–æ–∏—Å–∫</button>
            </div>
            <div id="obd-result" class="card" style="margin-top: 15px;">
                –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏...
            </div>
        </section>

        <section id="p-ai" class="page">
            <h2>–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button onclick="window.open('https://gemini.google.com')">Gemini</button>
                <button onclick="window.open('https://notebooklm.google.com')">NotebookLM</button>
            </div>
            <div class="card" style="margin-top: 15px;">
                <h3>–ü—Ä–æ–º–ø—Ç –Ω–µ–¥–µ–ª–∏:</h3>
                <code style="display:block; background:#f0f0f0; color: #333; padding: 10px; border-radius: 5px;">
                    "–†–∞—Å—Å—á–∏—Ç–∞–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —Å–µ—á–µ–Ω–∏–µ –∫–∞–±–µ–ª—è –¥–ª—è 12–í —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ —Ç–æ–∫–µ 40–ê –∏ –¥–ª–∏–Ω–µ –ª–∏–Ω–∏–∏ 5 –º–µ—Ç—Ä–æ–≤ —Å –ø–∞–¥–µ–Ω–∏–µ–º –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –Ω–µ –±–æ–ª–µ–µ 3%..."
                </code>
            </div>
        </section>

        <section id="p-joke" class="page">
            <h2>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —é–º–æ—Ä</h2>
            <div class="card">
                <p>‚Äî –ü–æ—á–µ–º—É –º–µ—Ö–∞–Ω–∏–∫–∏ –Ω–µ –ª—é–±—è—Ç –ª–µ–≤—à–µ–π?<br>‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–∏—Ö —Ä–µ–∑—å–±–∞ –≤ –¥—Ä—É–≥—É—é —Å—Ç–æ—Ä–æ–Ω—É –≤ –≥–æ–ª–æ–≤–µ!</p>
                <div style="text-align: right; color: var(--accent-color);">Rating: +42</div>
            </div>
            <button>üòÇ –†–∞—Å—Å–∫–∞–∑–∞—Ç—å —Å–≤–æ–π</button>
        </section>
    </main>

    <div id="modal-settings">
        <div class="card" style="width: 90%; max-width: 400px;">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <label>–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:</label>
            <select onchange="setTheme(this.value)">
                <option value="default">–°–∏–Ω—è—è –ò–∑–æ–ª–µ–Ω—Ç–∞ (–ö–ª–∞—Å—Å–∏–∫–∞)</option>
                <option value="theme-dark">–ù–æ—á–Ω–∞—è —Å–º–µ–Ω–∞</option>
                <option value="theme-grease">–í –º–∞—Å–ª–µ (–ì–∞—Ä–∞–∂)</option>
                <option value="theme-blueprint">–ß–µ—Ä—Ç–µ–∂</option>
                <option value="theme-safety">–¢–µ—Ö–Ω–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</option>
            </select>
            
            <div style="margin-top: 20px; text-align: center;">
                <p>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (QR-–∫–æ–¥):</p>
                <img id="qr-code" src="" alt="QR" style="width: 150px; border: 5px solid white;">
            </div>
            
            <button onclick="toggleSettings()" style="margin-top: 20px;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∫–æ–Ω–æ–∫ ---
        lucide.createIcons();

        // --- –ù–∞–≤–∏–≥–∞—Ü–∏—è ---
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            event.currentTarget.classList.add('active');
            window.scrollTo(0,0);
        }

        // --- –ö–∞–ª–µ–Ω–¥–∞—Ä—å ---
        let currentDate = new Date();
        const holidays = ["01-01", "01-07", "03-08", "05-01", "05-09", "07-03", "11-07", "12-25"];
        const murphyQuotes = [
            "–í—Å—ë, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫, –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫.",
            "–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–∞–º–∏–º —Å–µ–±–µ, —Å–æ–±—ã—Ç–∏—è –∏–º–µ—é—Ç —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –æ—Ç –ø–ª–æ—Ö–æ–≥–æ –∫ —Ö—É–¥—à–µ–º—É.",
            "–ï—Å–ª–∏ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –≤—Å—ë —Ö–æ—Ä–æ—à–æ, –≤—ã –ø—Ä–æ—Å—Ç–æ —á–µ–≥–æ-—Ç–æ –Ω–µ –∑–∞–º–µ—Ç–∏–ª–∏.",
            "–ë—Ä–∏—Ç–≤–∞ –û–∫–∫–∞–º–∞: –ù–µ —Å–ª–µ–¥—É–µ—Ç –º–Ω–æ–∂–∏—Ç—å —Å—É—â–µ–µ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏."
        ];

        function renderCalendar() {
            const body = document.getElementById('calendar-body');
            const title = document.getElementById('cal-title');
            body.innerHTML = '';
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            title.innerText = new Intl.DateTimeFormat('ru-RU', {month:'long', year:'numeric'}).format(currentDate);

            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
            ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'].forEach(d => {
                body.innerHTML += `<div style="font-weight:bold; opacity:0.5">${d}</div>`;
            });

            const firstDay = new Date(year, month, 1).getDay();
            const offset = firstDay === 0 ? 6 : firstDay - 1;
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            for(let i=0; i<offset; i++) body.innerHTML += '<div></div>';

            for(let d=1; d<=daysInMonth; d++) {
                const dateStr = `${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const isHoliday = holidays.includes(dateStr);
                const isToday = new Date().toDateString() === new Date(year, month, d).toDateString();
                const dayOfWeek = new Date(year, month, d).getDay();
                const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
                
                body.innerHTML += `
                    <div class="day ${isHoliday?'holiday':''} ${isToday?'today':''} ${isWeekend?'weekend':''}">
                        ${d}
                    </div>`;
            }
            
            // –†–æ—Ç–∞—Ü–∏—è —Ü–∏—Ç–∞—Ç
            document.getElementById('murphy-quote').innerText = murphyQuotes[d % murphyQuotes.length];
        }

        function changeMonth(delta) {
            currentDate.setMonth(currentDate.getMonth() + delta);
            renderCalendar();
        }

        // --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –¢–µ–º—ã ---
        function toggleSettings() {
            const m = document.getElementById('modal-settings');
            const isVisible = m.style.display === 'flex';
            m.style.display = isVisible ? 'none' : 'flex';
            if(!isVisible) {
                const url = encodeURIComponent(window.location.href);
                document.getElementById('qr-code').src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${url}`;
            }
        }

        function setTheme(theme) {
            document.body.className = theme === 'default' ? '' : theme;
            localStorage.setItem('pref-theme', theme);
        }

        // --- OBD –ü–æ–∏—Å–∫ ---
        function searchOBD() {
            const code = document.getElementById('obd-search').value.toUpperCase();
            const result = document.getElementById('obd-result');
            const db = {
                "P0101": "–í—ã—Ö–æ–¥ —Å–∏–≥–Ω–∞–ª–∞ –¥–∞—Ç—á–∏–∫–∞ –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞.",
                "P0300": "–°–ª—É—á–∞–π–Ω—ã–µ/–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–∂–∏–≥–∞–Ω–∏—è.",
                "520204": "–û—à–∏–±–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è –º–∞—Å–ª–∞ (MTZ/John Deere —Å–ø–µ—Ü–∏—Ñ–∏–∫)."
            };
            result.innerHTML = db[code] ? `<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong><br>${db[code]}` : "–ö–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ç–∏.";
        }

        // --- Offline / PWA Service Worker Stub ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º PWA –∑–¥–µ—Å—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è sw.js
                console.log('PWA Ready');
            });
        }

        // --- –ó–∞–ø—É—Å–∫ ---
        renderCalendar();
        const savedTheme = localStorage.getItem('pref-theme');
        if(savedTheme) setTheme(savedTheme);

        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∂–µ—Å—Ç–æ–≤ (—Å–≤–∞–π–ø)
        let touchStart = 0;
        document.addEventListener('touchstart', e => touchStart = e.changedTouches[0].screenX);
        document.addEventListener('touchend', e => {
            let touchEnd = e.changedTouches[0].screenX;
            if (touchStart - touchEnd > 100) changeMonth(1); // –°–≤–∞–π–ø –≤–ª–µ–≤–æ
            if (touchEnd - touchStart > 100) changeMonth(-1); // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ
        });
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ (BroadcastChannel API)
        const bc = new BroadcastChannel('sync_channel');
        bc.onmessage = (ev) => {
            if(ev.data === 'update') location.reload();
        };
    </script>
</body>
</html>
