<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ê–†–¢–ï–õ–¨ –§–û–†–î–û–í–ê –ò –ë–ï–ù–¶–û–í–ê</title>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <style>
        [x-cloak] { display: none !important; }
        :root { --blue-tape: #0047ab; --neon-orange: #ff5e00; --steel: #bdc3c7; }
        body { background: #1a1a1a; color: var(--steel); font-family: 'Courier New', monospace; margin: 0; padding-bottom: 80px; transition: 0.3s; }
        
        /* –¢–µ–º—ã */
        .theme-rust { background: #3d1a00; }
        .theme-oil { background: #000; color: #555; }

        .page { display: none; padding: 20px; }
        .active { display: block !important; }
        .gost-card { border: 1px solid var(--blue-tape); padding: 15px; margin-bottom: 10px; background: rgba(0,71,171,0.1); border-radius: 2px; }
        
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: #000; display: flex; justify-content: space-around; padding: 15px 0; border-top: 2px solid var(--blue-tape); z-index: 1000; }
        .nav-item { color: var(--steel); cursor: pointer; }
        .active-nav { color: var(--neon-orange) !important; }
        
        .btn-pusker { background: var(--blue-tape); color: white; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        input { background: #222; border: 1px solid var(--blue-tape); color: white; padding: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #444; padding: 8px; text-align: center; }
        th { background: var(--blue-tape); color: white; }
    </style>
</head>
<body x-data="artelCore" x-cloak :class="theme">

    <header style="text-align: center; border-bottom: 2px solid var(--blue-tape); padding: 10px; background: #000;">
        <h2 style="margin: 0; font-size: 1rem; letter-spacing: 2px;">üõ† –ê–†–¢–ï–õ–¨ –§–û–†–î–û–í–ê –ò –ë–ï–ù–¶–û–í–ê üõ†</h2>
    </header>

    <div :class="{ 'active': page === 1 }" class="page">
        <div class="gost-card">
            <div style="color: var(--neon-orange); font-weight: bold;" x-text="currentHoliday"></div>
            <div style="font-size: 0.8rem; font-style: italic; margin-top: 5px;" x-text="'¬´' + dailyQuote + '¬ª'"></div>
        </div>
        <h3 style="color: var(--neon-orange);">–£–°–¢–ê–í –ê–†–¢–ï–õ–ò</h3>
        <template x-for="(z, i) in zapovedi" :key="i">
            <div class="gost-card" style="font-size: 0.85rem;" x-text="(i+1) + '. ' + z"></div>
        </template>
    </div>

    <div :class="{ 'active': page === 2 }" class="page">
        <h3 style="color: var(--neon-orange);">–†–ê–î–ò–û–†–£–ë–ö–ê</h3>
        <div style="height: 300px; overflow-y: auto; border: 1px solid var(--blue-tape); padding: 10px; background: #000; margin-bottom: 10px;">
            <template x-for="m in messages">
                <div style="margin-bottom: 10px; border-left: 3px solid var(--blue-tape); padding-left: 8px;">
                    <small x-text="m.username" style="color: var(--neon-orange);"></small><br>
                    <span x-text="m.text"></span>
                </div>
            </template>
        </div>
        <div style="display: flex; gap: 5px;">
            <input type="text" x-model="msg" style="flex: 1;" placeholder="–ü—Ä–∏—ë–º...">
            <button @click="sendMsg" class="btn-pusker">–ü–£–°–ö</button>
        </div>
    </div>

    <div :class="{ 'active': page === 4 }" class="page">
        <h3 style="color: var(--neon-orange);">–°–ü–†–ê–í–û–ß–ù–ò–ö –†–ï–ó–¨–ë</h3>
        
        <table>
            <thead><tr><th>M</th><th>–®–∞–≥</th><th>–°–≤–µ—Ä–ª–æ</th></tr></thead>
            <tbody>
                <template x-for="r in rezba">
                    <tr><td x-text="r.m"></td><td x-text="r.s"></td><td x-text="r.d" style="color: var(--neon-orange);"></td></tr>
                </template>
            </tbody>
        </table>
        
        <h3 style="color: var(--neon-orange); margin-top: 20px;">OBD-II –ö–û–î–´</h3>
        <input type="text" x-model="obdQuery" placeholder="P0300" style="width: 100%; box-sizing: border-box;">
        <div style="margin-top: 10px; padding: 10px; background: #000; border: 1px solid var(--neon-orange);" x-text="scanOBD()"></div>
    </div>

    <div :class="{ 'active': page === 8 }" class="page">
        <h3 style="color: var(--neon-orange);">–ù–ê–°–¢–†–û–ô–ö–ò</h3>
        <div class="gost-card">
            <label>–¢–µ–º–∞:</label>
            <select x-model="theme" @change="setTheme($el.value)" style="width: 100%; padding: 10px; background: #222; color: white; border: 1px solid var(--blue-tape);">
                <option value="theme-classic">–°–∏–Ω—è—è –∏–∑–æ–ª–µ–Ω—Ç–∞</option>
                <option value="theme-oil">–ú–∞–∑—É—Ç (Dark)</option>
                <option value="theme-rust">–†–∂–∞–≤—á–∏–Ω–∞</option>
            </select>
        </div>
        <div id="qrcode" style="display: flex; justify-content: center; background: white; padding: 10px; margin-top: 20px;"></div>
    </div>

    <nav class="nav-bar">
        <template x-for="(icon, index) in navIcons">
            <div class="nav-item" :class="{ 'active-nav': page === (index + 1) }" @click="page = (index + 1); setTimeout(() => lucide.createIcons(), 50)">
                <i :data-lucide="icon"></i>
            </div>
        </template>
    </nav>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('artelCore', () => ({
                page: 1,
                theme: localStorage.getItem('artel_theme') || 'theme-classic',
                username: '–ò–Ω–∂–µ–Ω–µ—Ä-' + Math.floor(Math.random() * 99),
                msg: '',
                messages: [{username: '–°–∏—Å—Ç–µ–º–∞', text: '–°–≤—è–∑—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ê—Ä—Ç–µ–ª—å.'}],
                obdQuery: '',
                currentHoliday: '–†–∞–±–æ—á–∞—è —Å–º–µ–Ω–∞',
                dailyQuote: '–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –≤–æ–∑—å–º–∏ —Ä—ã—á–∞–≥ –±–æ–ª—å—à–µ.',
                navIcons: ['home', 'message-circle', 'package', 'wrench', 'zap', 'brain-circuit', 'laugh', 'settings'],
                
                zapovedi: ["–¢–ë ‚Äî –Ω–µ –¥–æ–≥–º–∞, –∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è.", "–°–∏–Ω—è—è –∏–∑–æ–ª–µ–Ω—Ç–∞ –ª–µ—á–∏—Ç –≤—Å—ë.", "–õ–∏—à–Ω—è—è –¥–µ—Ç–∞–ª—å ‚Äî —ç—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è."],
                rezba: [{m:'M6', s:'1.0', d:'5.0'}, {m:'M8', s:'1.25', d:'6.8'}, {m:'M10', s:'1.5', d:'8.5'}],

                init() {
                    lucide.createIcons();
                    this.updateStats();
                    this.generateQR();
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase (–±–µ–∑ –≤—ã–ª–µ—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ)
                    try {
                        const sb = supabase.createClient('https://grsszunlfmehyykkvccj.supabase.co', 'ZTEGCDF4981E');
                        sb.from('artel_messages').select('*').limit(10).then(({data}) => { if(data) this.messages = data; });
                    } catch(e) {}
                },

                updateStats() {
                    const holidays = {"01-01": "–ù–æ–≤—ã–π –≥–æ–¥", "05-09": "–î–µ–Ω—å –ü–æ–±–µ–¥—ã", "07-03": "–î–µ–Ω—å –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –†–ë"};
                    const day = new Date().toISOString().slice(5,10);
                    this.currentHoliday = holidays[day] || "–û–±—ã—á–Ω—ã–π –¥–µ–Ω—å –≤ –≥–∞—Ä–∞–∂–µ";
                },

                sendMsg() {
                    if(!this.msg) return;
                    this.messages.push({username: this.username, text: this.msg});
                    this.msg = '';
                },

                scanOBD() {
                    const codes = {"P0300": "–ü—Ä–æ–ø—É—Å–∫–∏ –∑–∞–∂–∏–≥–∞–Ω–∏—è", "P0171": "–ë–µ–¥–Ω–∞—è —Å–º–µ—Å—å"};
                    return codes[this.obdQuery.toUpperCase()] || "–ö–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Ç–∞–∫—Ç—ã.";
                },

                setTheme(t) {
                    this.theme = t;
                    localStorage.setItem('artel_theme', t);
                },

                generateQR() {
                    const qr = qrcode(0, 'M');
                    qr.addData(window.location.href);
                    qr.make();
                    document.getElementById('qrcode').innerHTML = qr.createImgTag(4);
                }
            }));
        });
    </script>
</body>
</html>
